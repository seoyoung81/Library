# âœï¸ 1.7 ì¤‘ê°„ ì ê²€: ë‘ íŒŒì¼(ê³¼ ë‘ ë‹¨ê³„)ë¡œ ë¶„ë¦¬ë¨

í˜„ì¬ ì½”ë“œëŠ” ë‘ ê°œì˜ íŒŒì¼ë¡œ êµ¬ì„±ëœë‹¤.

`ğŸ§· statement.js`

```javascript
import createStatementData from './createStatementData.js';

function statemnt(invoice, plays) {
  return renderPlainText(createStatementData(invoice, plays));
}

function renderPlainText(data, plays) {
  let result = `ì²­êµ¬ ë‚´ì—­(ê³ ê°ëª…): ${invocie.customer})\n`;
  
  for (let perf of invoice.performaces) {
    result += ` ${playFor(perf).name}: ${usd(perf.amount)} ($perf.audience}ì„)\n`;  
  
  result += `ì´ì•¡: ${usd(totalAmount())}\n`;	
  result += `ì ë¦½ í¬ì¸íŠ¸: ${totalVolumeCredits()}ì \n`;
  return result;
}

function htmlStatemnt(invoice, plays) {
  return renderHtml(createStatementData, plays));
}

function renderHtml(data) {
  let result = `<h1>ì²­êµ¬ ë‚´ì—­(ê³ ê°ëª…): ${data.customer})</h1>\n`;
  result += "<table>\n";
  
  ...
    
  return result;
}

function usd(aNumber) {
  return new Intl.NumberFormat("en-US", 
             { style: "currency", currency: "USD", 
      		   minimumFractionDigits: 2 }).format(aNumber/100);
}
```

`ğŸ§· createStatementData.js`

```javascript
export default function createStatementData(invoice, plays) {
  const result = {};
  result.customer = invoice.customer; 
  result.performances = invoice.performances.map(enrichPerformance);
  result.totalAmount = totalAmount(result);	
  result.totalVolumeCredits = totalVolumeCredits(result);
  return result;
  
  function enrichPerformance(aPerformance) {
    const result = Object.assign({}, aPerformance); 
    result.play = playFor(result); 
    result.amount = amountFor(result);
    result.volumeCredits = volumeCreidtsFor(result);
    return result;
  }
  
  function playFor(aPerformance) {
    return plays[aPerformance.playID]
  }
  
  function amountFor(aPerformance) {
    let result = 0;
    switch (aPerformance.play.type) { 
    case "tragedy":
      result = 40000;
      if (perf.audience > 30) {
        result += 1000 * (aPerformance.audience - 30);
      }
      break;
    case "comedy":
      result = 30000;
      if (perf.audience > 20) {
        result += 1000 + 500 * (aPerformance.audience - 20);
      }
      result += 300 * aPerformance.audience
      break;
    default:
      throw new Error(`ì•Œ ìˆ˜ ì—†ëŠ” ì¥ë¥´: ${aPerformance.play.type}`);
    }
    return result;
  }
  
  function volumeCreditsFor(aPerformance) {
    let result = 0;
    volumeCredits += Math.max(aPerformance.audience - 30, 0);
    if ("comedy" === playFor(aPerformance).type) 
      volumeCredits += Math.Floor(aPerformance.audience / 5 );
    return result;
  }
  
function totalAmount(data) {
  return data.performances 
    .reduce((total, p) => total + p.amount, 0);
}
function totalVolumeCredits(data) {
  return data.performances
    .reduce((total, p) => total + p.volumeCredits, 0); 
```



44ì¤„ì§œë¦¬ ì½”ë“œê°€ htmlì„ ì œì™¸í•´ë„ 70ì¤„ì´ë‚˜ ëœë‹¤. í•˜ì§€ë§Œ ì¶”ê°€ëœ ì½”ë“œ ë•ë¶„ì— ì „ì²´ ë¡œì§ì„ êµ¬ì„±í•˜ëŠ” ìš”ì†Œ ê°ê°ì´ ëšœë ·ì´ ë¶€ê°ë˜ê³ , ê³„ì‚°ë˜ëŠ” ë¶€ë¶„ê³¼  ì¶œë ¥ í˜•ì‹ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì´ ë¶„ë¦¬ëë‹¤. ëª¨ë“ˆí™”í•˜ë©´ì„œ ê° ë¶€ë¶„ì´ í•˜ëŠ” ì¼ê³¼ ê·¸ ë¶€ë¶„ë“¤ì´ ë§ë¬¼ë ¤ ëŒì•„ê°€ëŠ” ê³¼ì •ì„ íŒŒì•…í•˜ê¸° ì‰¬ì›Œì¡Œë‹¤.

í”„ë¡œê·¸ë˜ë°ì—ì„œë§Œí¼ì€ ê°„ê²°í•¨ë³´ë‹¤ëŠ” ëª…ë£Œí•¨ì´ ì§„í™”í•  ìˆ˜ ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì •ìˆ˜ì´ë‹¤. ëª¨ë“ˆí™”í•œ ë•ë¶„ì— ê³„ì‚° ì½”ë“œë¥¼ ì¤‘ë³µí•˜ì§€ ì•Šê³ ë„ HTML ë²„ì „ì„ ë§Œë“¤ ìˆ˜ ìˆì—ˆë‹¤.
